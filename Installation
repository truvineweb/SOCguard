A secure install on Kali, Windows prep (WinRM over HTTPS or SSH), running SOCguard to collect logs via your Collect-WindowsLogs.ps1, verifying the download with checksums, and friendly troubleshooting

#Install SOCguard on Kali Linux

#Direct from GitHub with pipx

sudo apt update
sudo apt install -y python3 python3-venv python3-pip pipx git
python3 -m pipx ensurepath
export PATH="$HOME/.local/bin:$PATH"

# Install your repo directly
pipx install "git+https://github.com/truvineweb/socguard.git@main"

# Confirm the CLI is on PATH
socguard --help

#Prepare the Windows service (not files): WinRM or SSH only

	•	WinRM over HTTPS (recommended): create a listener w/ TLS; SOCguard validates the cert (use org CA or pass --winrm-ca).
	•	Or SSH (alternative): enable OpenSSH Server on Windows and use an SSH key.

#powershell
# WinRM HTTPS (Administrator PowerShell)
winrm quickconfig -force
$cert = New-SelfSignedCertificate -DnsName $env:COMPUTERNAME -CertStoreLocation Cert:\LocalMachine\My
$thumb = $cert.Thumbprint
winrm create winrm/config/Listener?Address=*+Transport=HTTPS "@{Hostname=`"$env:COMPUTERNAME`"; CertificateThumbprint=`"$thumb`"}"
winrm set winrm/config/service/auth '@{Basic="true";Negotiate="true"}'
New-NetFirewallRule -DisplayName "WinRM HTTPS" -Direction Inbound -Protocol TCP -LocalPort 5986 -Action Allow

#(SSH alternative also works — enable sshd, open TCP/22.)

#Run SOCguard from Kali using your GitHub Raw URL
#LInux Bash

# Safer than putting passwords on the command line:
read -s SOCGUARD_PASS && export SOCGUARD_PASS

SCRIPT_URL="https://raw.githubusercontent.com/truvineweb/socguard/refs/heads/main/Windows/Collect-WindowsLogs.ps1"

socguard \
  --target 192.168.1.100 \
  --username 'admin' \
  --password "$SOCGUARD_PASS" \
  --output "$HOME/socguard_out" \
  --script-url "$SCRIPT_URL" \
  --remote-workdir 'C:\ProgramData\SOCguard' \
  --transport winrm

#Prefer SSH? Use --transport ssh and --key-file ~/.ssh/id_ed25519 (no password flag). Same --script-url and --remote-workdir apply.

socguard \
  --target 192.168.1.100 \
  --username 'admin' \
  --key-file ~/.ssh/id_ed25519 \
  --output "$HOME/socguard_out" \
  --script-url "$SCRIPT_URL" \
  --remote-workdir 'C:\ProgramData\SOCguard' \
  --transport ssh

#Verify on Kali
After a successful run, you'll have something like:

~/socguard_out/
  System_Logs_20251017_111004.zip
  System_Logs_20251017_111004.sha256.txt   (if present)


cd "$HOME/socguard_out"

# See files
ls -lh

# Peek inside without extracting
unzip -l System_Logs_*.zip

# Check SHA-256
# Show what SOCguard computed (or compute now if no sidecar)
sha256sum System_Logs_*.zip

# Peek at sidecar (if downloaded from Windows)
cat System_Logs_*.sha256.tx

# Optional: extract and glance at CSVs
mkdir -p tmp && unzip -q System_Logs_*.zip -d tmp
head -n 5 tmp/*_Logs_*.csv

#count record
wc -l tmp/*.csv




*#Troubleshooting (no Windows file placement required)*
- WinRM HTTPS reachable?

nmap -p 5986 192.168.1.100
curl -vk https://192.168.1.100:5986/wsman   # 401 is normal without creds

- SSH reachable?

nmap -p 22 192.168.1.100


#If Download of script fails on Windows:
	•	Ensure the Raw URL is correct.

#If No ZIP found: your collector didn’t generate System_Logs_*.zip in C:\ProgramData\SOCguard\out.
	•	Check the script’s output directory param. We run it with -OutputDirectory "C:\ProgramData\SOCguard\out".
	•	Confirm the Windows session has rights (for Security logs, best to run as admin).




